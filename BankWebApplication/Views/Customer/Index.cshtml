@using System.Collections.Specialized
@using Microsoft.EntityFrameworkCore.Scaffolding


@model BankWebbApp.ViewModels.CustomerIndexViewModel

@{ ViewData["Title"] = "Customers"; }




<section class="py-5">

    <div class="row">
        <div class="col-lg-12 mb-5">
            <div class="card">
                <div class="card-header">
                    <h3 class="h6 text-uppercase mb-0">Sök</h3>
                </div>
                <div class="card-body">


                    <form method="get" asp-controller="Customer" asp-action="Index">

                        <div class="form-row align-items-center">
                            <div class="col-auto">
                                <input type="text" class="form-control" asp-for="q">
                            </div>
                            <div class="col-auto">
                                <button type="submit" class="btn btn-primary">Sök</button>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
    </section>



    <section class="py-5">




        <div class="row">



            <div class="col-lg-12 mb-5">
                <div class="card">
                    <div class="card-header">
                        <h3 class="h6 text-uppercase mb-0">Customer</h3>
                    </div>
                    <div class="card-body">
                        <table class="table table-hover">
                            <thead>
                                <tr>

                                    <th scope="col">

                                        <a asp-controller="Customer"
                                           asp-action="Index"
                                           asp-route-sortField="CustomerId"
                                           asp-route-sortOrder="@(Model.sortField == "CustomerId" ? Model.OppositeSortOrder : "" )"
                                           asp-route-page="@(Model.Page)"
                                           asp-route-q="@Model.q">
                                            CustomerId
                                            @if (Model.sortField == "CustomerId")
                                            {
                                                if (Model.sortOrder == "asc")
                                                {
                                                    <i class="fas fa-sort-down"></i> }
                                                else
                                                {
                                                    <i class="fas fa-sort-up"></i>}

                                            }

                                        </a>
                                    </th>
                                    <th scope="col">
                                        <a asp-controller="Customer"
                                           asp-action="Index"
                                           asp-route-sortField="Givenname"
                                           asp-route-sortOrder="@(Model.sortField == "Givenname" ? Model.OppositeSortOrder : "" )"
                                           asp-route-page="@(Model.Page)"
                                           asp-route-q="@Model.q">
                                            Name
                                            @if (Model.sortField == "Givenname")
                                            {
                                                if (Model.sortOrder == "asc")
                                                {
                                                    <i class="fas fa-sort-down"></i> }
                                                else
                                                {
                                                    <i class="fas fa-sort-up"></i>}

                                            }

                                        </a>
                                    </th>
                                    <th scope="col">

                                        <a asp-controller="Customer"
                                           asp-action="Index"
                                           asp-route-sortField="NationalId"
                                           asp-route-sortOrder="@(Model.sortField == "NationalId" ? Model.OppositeSortOrder : "" )"
                                           asp-route-page="@(Model.Page)"
                                           asp-route-q="@Model.q">
                                            NationalId
                                            @if (Model.sortField == "NationalId")
                                            {
                                                if (Model.sortOrder == "asc")
                                                {
                                                    <i class="fas fa-sort-down"></i> }
                                                else
                                                {
                                                    <i class="fas fa-sort-up"></i>}

                                            }

                                        </a>
                                    </th>



                                    <th scope="col">

                                        <a asp-controller="Customer"
                                           asp-action="Index"
                                           asp-route-sortField="StreetAdress"
                                           asp-route-sortOrder="@(Model.sortField == "StreetAdress" ? Model.OppositeSortOrder : "" )"
                                           asp-route-page="@(Model.Page)"
                                           asp-route-q="@Model.q">
                                            StreetAdress
                                            @if (Model.sortField == "StreetAdress")
                                            {
                                                if (Model.sortOrder == "asc")
                                                {
                                                    <i class="fas fa-sort-down"></i> }
                                                else
                                                {
                                                    <i class="fas fa-sort-up"></i>}

                                            }

                                        </a>
                                    </th>

                                    <th scope="col">

                                        <a asp-controller="Customer"
                                           asp-action="Index"
                                           asp-route-sortField="City"
                                           asp-route-sortOrder="@(Model.sortField == "City" ? Model.OppositeSortOrder : "" )"
                                           asp-route-page="@(Model.Page)"
                                           asp-route-q="@Model.q">
                                            City
                                            @if (Model.sortField == "City")
                                            {
                                                if (Model.sortOrder == "asc")
                                                {
                                                    <i class="fas fa-sort-down"></i> }
                                                else
                                                {
                                                    <i class="fas fa-sort-up"></i>}

                                            }

                                        </a>
                                    </th>



                                    <th scope="col"></th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var customer in Model.Customers)
                                {
                            <tr>
                                <td>@customer.CustomerId</td>

                                <td>@customer.Givenname</td>
                                <td>@customer.NationalId</td>
                                <td>@customer.Streetaddress</td>
                                <td>@customer.City</td>

                                
          
                            <td><a asp-controller="Customer" asp-action="CustomerDetails" asp-route-Id="@customer.CustomerId" class="btn btn-secondary active" role="button" aria-pressed="true">Customer Accounts</a></td>
                            </tr>
                            }

                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="5">
                                        <nav aria-label="...">
                                            <ul class="pagination">
                                                <li class="page-item @(Model.Page == 1 ? "disabled" : "")">

                                                    <a class="page-link"
                                                       asp-controller="Customer"
                                                       asp-action="Index"
                                                       asp-route-sortField="@Model.sortField"
                                                       asp-route-sortOrder="@Model.sortOrder"
                                                       asp-route-page="@(Model.Page - 1)"
                                                       asp-route-q="@Model.q">Previous</a>
                                                </li>


                                                @for (int pa = 1; pa <= Model.TotalPages; pa++)
                                                {

                                                    <li class="page-item @(pa == Model.Page ? "active" : "")">
                                                        <a class="page-link"
                                                           asp-controller="Customer"
                                                           asp-action="Index"
                                                           asp-route-sortField="@Model.sortField"
                                                           asp-route-sortOrder="@Model.sortOrder"
                                                           asp-route-page="@pa"
                                                           asp-route-q="@Model.q">
                                                            @pa
                                                        </a>
                                                    </li>
                                                }



                                                <li class="page-item @(Model.Page == Model.TotalPages  ? "disabled" : "")">
                                                    <a class="page-link"
                                                       asp-controller="Customer"
                                                       asp-action="Index"
                                                       asp-route-sortField="@Model.sortField"
                                                       asp-route-sortOrder="@Model.sortOrder"
                                                       asp-route-page="@(Model.Page + 1)"
                                                       asp-route-q="@Model.q">Next</a>
                                                </li>
                                            </ul>
                                        </nav>
                                    </td>


                                    <td>
                                        @if (Model.Page > 1)
                                        {
                                            <a class="btn btn-primary"
                                               asp-controller="Customer"
                                               asp-action="Index"
                                               asp-route-sortField="@Model.sortField"
                                               asp-route-sortOrder="@Model.sortOrder"
                                               asp-route-page="@(Model.Page - 1)"
                                               asp-route-q="@Model.q">
                                                Prev
                                            </a>
                                        }
                                    </td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td>
                                        <a class="btn btn-primary"
                                           asp-controller="Customer"
                                           asp-action="Index"
                                           asp-route-sortField="@Model.sortField"
                                           asp-route-sortOrder="@Model.sortOrder"
                                           asp-route-page="@(Model.Page + 1)"
                                           asp-route-q="@Model.q">
                                            Next
                                        </a>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>


                    </div>
                </div>
            </div>


        </div>
    </section>

